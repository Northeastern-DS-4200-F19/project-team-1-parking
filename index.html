<!DOCTYPE html>
<html lang="en">
  <!-- Metadata -->
	<head>
    <meta charset="utf-8">

    <!-- Title -->
		<title>Project Team #1: Parking, DS 4200 F19</title>

    <!-- CSS Styling -->
		<link rel="stylesheet" href="style.css">

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
    <link rel="manifest" href="/favicons/site.webmanifest">
    <link rel="shortcut icon" href="/favicons/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
	</head>

  <!-- Main page content -->
	<body>

    <!-- Update this with your GitHub repo URL -->
    <span id="forkongithub"><a href="https://github.com/Northeastern-DS-4200-F19/project-team-1-parking">Fork me on GitHub</a></span>

    <!-- Your writeup goes here -->

    <div class = "content-column">

      <h1>Project Team #1: Parking, DS 4200 F19</h1>
			<p><strong> Title: A day's worth of parking in Chester Square</strong><p>

      <p><strong>Brian Fogarty</strong>, <strong> Ysabelle Kempe</strong>, <strong>Lal  Birali</strong>, <strong>Victoria Yang</strong></p>

      <p>Service-Learning Course Project as part of <a href="http://www.ccs.neu.edu/home/cody/courses/ds4200-f19/">DS 4200: Information Presentation and Visualization</a>, taught by <a href="https://cody.khoury.northeastern.edu/">Prof. Cody Dunne</a>, <a href="https://visualization.khoury.northeastern.edu/">Data Visualization @ Khoury</a>, <a href="https://www.khoury.northeastern.edu/">Northeastern University</a>.</p>


      <h1>Motivation</h1>

	  <p> This project was developed in conjunction with the Chester Square Neighborhood
			Association. The goal of the Neighborhood Association is to show that there is a problem with
			parking availability and distribution in the area. Residents are often unable to find
			parking close to their homes, and there are complaints of inefficient parking practices.</p>
	  <p> The Neighborhood Association wants to bring the problem of parking to the
			attention of local government. The Association already knows there is a problem
			and is able to explain the issue and potential causes in words (e.g., not
			enough parking, residents donâ€™t know where to park, etc.), but they want to
			be able to show numbers that prove their point.  </p>
	  <p> We hope this project serves as a valuable tool for the Neighborhood Association
			to communicate the need for change to authorities. Cars are a key player in daily
			urban life, and parking needs to be taken seriously in order to create
			a better standard of living for those on both sides of Chester Square.</p>
		<p> When designing our project, we asked ourselves how occupied Chester Square parking
			is throughout the day. We wanted our final piece to show change over time, as well as give users
			an idea of how difficult it is to find parking at any given time. Through our own research
			and data collection, we have concluded that a reasonable response would be
			to more clearly mark parking spots, as well as conduct another survey.</p>

      <h1>Visualization</h1>

      <p><em>Include the interactive visualization as part of this page. Static example follows.</em></p>

    </div>


    <!-- Your visualization here -->
	<svg width="500" height="600"></svg>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.2.2/d3.min.js"></script>
	<script>
		var pointRadius = 3;
		var trapNodeShift = 0.09375;

		var xMinScale = pointRadius + 20;
		var xMaxScale = 250;

		var yMinScale = xMinScale + 20;
		var yMaxScale = xMaxScale + 20;

		d3.select('body')
		.append('svg')
		.attr('width', xMaxScale + 20)
		.attr('height', yMaxScale + 20);

		var jointNodes = [{
		  jointID: 0,
		  x: 0,
		  y: 0
		},{
		  jointID: 0.1,
		  x: trapNodeShift,
		  y: trapNodeShift
		},{
		  jointID: -0.1,
		  x: trapNodeShift,
		  y: -trapNodeShift
		},{
		  jointID: 0.9,
		  x: 0.5 - trapNodeShift,
		  y: trapNodeShift
		},{
		  jointID: -0.9,
		  x: 0.5 - trapNodeShift,
		  y: -trapNodeShift
		},{
		  jointID: 1,
		  x: 0.5,
		  y: 0
		},{
		  jointID: 1.1,
		  x: 0.5 + trapNodeShift,
		  y: trapNodeShift
		},{
		  jointID: -1.1,
		  x: 0.5 + trapNodeShift,
		  y: -trapNodeShift
		},{
		  jointID: 1.9,
		  x: 1 - trapNodeShift,
		  y: trapNodeShift
		},{
		  jointID: -1.9,
		  x: 1 - trapNodeShift,
		  y: -trapNodeShift
		},{
		  jointID: 2,
		  x: 1,
		  y: 0
		},{
		  jointID: 2.1,
		  x: 1 + trapNodeShift,
		  y: trapNodeShift
		},{
		  jointID: 2.9,
		  x: 1 - trapNodeShift,
		  y: 2 - trapNodeShift
		},{
		  jointID: -2.9,
		  x: 1 + trapNodeShift,
		  y: 2 - trapNodeShift
		},{
		  jointID: 3,
		  x: 1,
		  y: 2
		},{
		  jointID: 3.1,
		  x: 1 - trapNodeShift,
		  y: 2 + trapNodeShift
		},{
		  jointID: 4,
		  x: 0.5,
		  y: 2
		},{
		  jointID: 5,
		  x: 0,
		  y: 2
		},{
		  jointID: 6,
		  x: 0.5,
		  y: 0.5
		},{
		  jointID: 7,
		  x: 0.5,
		  y: 1.5
		},{
		  jointID: 8,
		  x: 0.3125,
		  y: 0.75
		},{
		  jointID: 9,
		  x: 0.3125,
		  y: 1.25
		},{
		  jointID: 10,
		  x: 0.6875,
		  y: 0.75
		},{
		  jointID: 11,
		  x: 0.6875,
		  y: 1.25
		}];

		var scaleX = d3.scaleLinear()
		  .domain([0, 1])
		  .range([xMinScale, xMaxScale]);

		var scaleY = d3.scaleLinear()
		  .domain([0, 1])
		  .range([yMinScale, yMaxScale]);

		d3.select('svg')
			.selectAll('circle')
			.data(jointNodes)
			.enter()
			.append('circle')
			.attr('r', pointRadius)
			.attr('cx', function(d) {
				return scaleX(d.x)
			})
			.attr('cy', function(d) {
				return scaleY(d.y)
			});

		var jointEdges = [
		  {
		    routeID: 1,
		    fromJointID: 4,
		    toJointID: 7
		  },{
		    routeID: 2.1,
		    fromJointID: 7,
		    toJointID: 11
		  },{
		    routeID: 2.2,
		    fromJointID: 11,
		    toJointID: 10
		  },{
		    routeID: 2.3,
		    fromJointID: 10,
		    toJointID: 6
		  },{
		    routeID: 3.1,
		    fromJointID: 7,
		    toJointID: 6
		  },{
		    routeID: 3.2,
		    fromJointID: 6,
		    toJointID: 1
		  },{
		    routeID: 4,
		    fromJointID: 1,
		    toJointID: 2
		  },{
		    routeID: 5,
		    fromJointID: 2,
		    toJointID: 1
		  },{
		    routeID: 6,
		    fromJointID: 1,
		    toJointID: 0
		  },{
		    routeID: 7,
		    fromJointID: 0,
		    toJointID: 1
		  },{
		    routeID: 8,
		    fromJointID: 1,
		    toJointID: 6
		  },{
		    routeID: 9.1,
		    fromJointID: 6,
		    toJointID: 8
		  },{
		    routeID: 9.2,
		    fromJointID: 8,
		    toJointID: 9
		  },{
		    routeID: 9.3,
		    fromJointID: 9,
		    toJointID: 7
		  },{
		    routeID: 10.1,
		    fromJointID: 6,
		    toJointID: 7
		  },{
		    routeID: 10.2,
		    fromJointID: 7,
		    toJointID: 4
		  },{
		    routeID: 11,
		    fromJointID: 4,
		    toJointID: 5
		  },{
		    routeID: 12,
		    fromJointID: 5,
		    toJointID: 0
		  },{
		    routeID: 13,
		    fromJointID: 2,
		    toJointID: 3
		  },{
		    routeID: 14,
		    fromJointID: 3,
		    toJointID: 4
		  }];


		var lineFunction = d3.line()
		  .x(function(d) { return scaleX(d.x); })
		  .y(function(d) { return scaleY(d.y); })
		  .curve(d3.curveLinear);

		// function drawParkingZone(fromNode, toNode){
		//   offsetVal = (1/32);

		//   var startNode = fromNode;
		//   var stopNode = toNode;
		//   var dX = stopNode.x - startNode.x;
		//   var dY = stopNode.y - startNode.y;

		//   var trapzPoints = [{
		//     x: startNode.x,
		//     y: startNode.y
		//   },{
		//     x: startNode.x + (offsetVal * dX + offsetVal * 2),
		//     y: startNode.y + (offsetVal * dY + offsetVal)
		//   },{
		//     x: stopNode.x + (offsetVal * dX + offsetVal * 2),
		//     y: stopNode.y + (offsetVal * dY + offsetVal)
		//   },{
		//     x: stopNode.x,
		//     y: stopNode.y
		//   }];

		//   d3.select('svg')
		//     .append('path')
		//     .attr('d', lineFunction(trapzPoints) + 'Z')
		//     .style('fill', 'orange')
		//     .style('stroke', 'black');
		// }

		function drawMidLine(fromNode, toNode){
		  d3.select('svg')
		    .append("line")
		    .style("stroke", "black")
		    .attr("x1", scaleX(fromNode.x))
		    .attr("y1", scaleY(fromNode.y))
		    .attr("x2", scaleX(toNode.x))
		    .attr("y2", scaleY(toNode.y));
		}

		function connectEdges(edge, edgeIndex) {
		  var fromNode = jointNodes.find(function(node) {
		    return node.jointID == edge.fromJointID;
		  })
		  var toNode = jointNodes.find(function(node) {
		    return node.jointID == edge.toJointID;
		  })
		  drawMidLine(fromNode, toNode);
		  // drawParkingZone(fromNode, toNode);
		}

		jointEdges.forEach(connectEdges);
	</script>

    <style>

      .axis .domain {
        display: none;
      }

      </style>
      <svg width="960" height="960"></svg>
      <script src="https://d3js.org/d3.v4.min.js"></script>
      <script>

      var svg = d3.select("svg"),
          margin = {top: 20, right: 20, bottom: 30, left: 120},
          width = +svg.attr("width") - margin.left - margin.right,
          // height = +svg.attr("height") - margin.top - margin.bottom,
          height =200;
          g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");

      var y = d3.scaleBand()
          .rangeRound([0, height])
          .paddingInner(0.05)
          .align(0.1);

      var x = d3.scaleLinear()
          .rangeRound([0, width]);	// .rangeRound([height, 0]);

      var z = d3.scaleOrdinal()
          .range(["#98abc5", "#8a80a6"]);

      d3.csv("data2.csv", function(d, i, columns) {
        for (i = 1, t = 0; i < columns.length; ++i) t += d[columns[i]] = +d[columns[i]];
        d.total = t;
        return d;
      }, function(error, data) {
        if (error) throw error;

        var keys = data.columns.slice(1);

        data.sort(function(a, b) { return b.total - a.total; });
        y.domain(data.map(function(d) { return d.State; }));
        x.domain([0, d3.max(data, function(d) { return d.total; })]).nice();
        z.domain(keys);

        g.append("g")
          .selectAll("g")
          .data(d3.stack().keys(keys)(data))
          .enter().append("g")
            .attr("fill", function(d) { return z(d.key); })
          .selectAll("rect")
          .data(function(d) { return d; })
          .enter().append("rect")
            .attr("y", function(d) { return y(d.data.State); })
            .attr("x", function(d) { return x(d[0]); })
            .attr("width", function(d) { return x(d[1]) - x(d[0]); })
            .attr("height", y.bandwidth());

        g.append("g")
            .attr("class", "axis")
            .attr("transform", "translate(0,0)")
            .call(d3.axisLeft(y));

        g.append("g")
            .attr("class", "axis")
          .attr("transform", "translate(0,"+height+")")
            .call(d3.axisBottom(x).ticks(null, "s"))
          .append("text")
            .attr("y", 2)
            .attr("x", x(x.ticks().pop()) + 0.5)
            .attr("dy", "0.32em")
            .attr("fill", "#000")
            .attr("font-weight", "bold")
            .attr("text-anchor", "start")
            .text("Parking Spots")
          .attr("transform", "translate("+ (-width) +",-10)");   	// Newline

        var legend = g.append("g")
            .attr("font-family", "sans-serif")
            .attr("font-size", 12)
            .attr("text-anchor", "end")
          .selectAll("g")
          .data(keys.slice().reverse())
          .enter().append("g")
         .attr("transform", function(d, i) { return "translate(-50," + (300 + i * 20) + ")"; });

        legend.append("rect")
            .attr("x", width - 19)
            .attr("width", 19)
            .attr("height", 10)
            .attr("fill", z);

        legend.append("text")
            .attr("x", width - 24)
            .attr("y", 9.5)
            .attr("dy", "0.32em")
            .text(function(d) { return d; });
      });

      </script>


    <div class="vis-holder">
      <!-- Change viewbox to whatever you want, e.g. "0 0 1000 6000" This determines your aspect ratio and coordinate system -->
      <!-- Delete all the sample SVG code below after the viewbox to before the closing tag. Populate this part of the SVG with D3. -->
      <svg id="vis-svg"
        preserveAspectRatio="xMidYMid meet" class="marks" viewBox="0 0 821 520">

      <!-- Don't delete the closing tag! -->
      </svg>
    </div>

    <!-- Your writeup goes here -->
    <div class = "content-column">

      <h1>Demo Video</h1>

      <p><em>Embedded MP4 demo video using the HTML5 &lt;video&gt; tag. For example, this screen recording Prof. Cody Dunne made of Mike Bostock's flexible transitions in D3 slide:</em></p>

      <video controls width="100%">
        <source src="http://www.ccs.neu.edu/home/cody/courses/shared/d3-flexible-transitions.mp4" type="video/mp4">
        <p>Your browser doesn't support HTML5 video. Here is
         a <a href="http://www.ccs.neu.edu/home/cody/courses/shared/d3-flexible-transitions.mp4">link to the video</a> instead.</p>
      </video>

      <h1>Visualization explanation</h1>

			<p>Our visualization includes an interactive map showing occupancy rate, as well
				a bar chart that shows the empty and occupied parking spots on each street.
				The user is able to use a slider to change the time of day, which is reflected in the
				visualizations. You can also filter based on regulation type.</p>
			<p>For our map, we used color to represent occupancy rate. We used a color scale of
				red, white, and green because we believed it was intuitive for red to mean that there
				are less spots available and green to mean there are more spots available. We designed
				the map to only show streets because we didn't want to clutter the visualizations with buildings or other landmarks.</p>
			<p>We included the bar chart as well because it is very important for a user
				not only to know the proportion of spots filled, but to know exactly how many
				spots are left. We used a simple stacked bar chart to show this data, which uses area to
				show the parking capacity of a certain street, as well as area and color to show the breakdown of
		  	empty versus occupied spots.</p>
			<p> For interactivity, our goal was to have the slider to change the time,
				checkboxes to filter by interactivity, and brushing and linking that would highlight the street
				in the bar chart when it is clicked on in the map view (and vice versa).</p>
			<p>Below, you can see screenshots of our final visualization.</p>
			<p>INSERT PNG HERE</p>
			<p>Below, you will find links to our presentation slides.</p>
			<p>INSERT LINK HERE</p>

      <p><em>final visualization screenshots (PNG images), design justifications, UI walk-through, and linked presentation slides.</em></p>

      <h1>Data Analysis</h1>
      <p><em>Summary of data, data types, and data preprocessing.</em></p>

      <p><em>Expectation: Data sources match the problem statement and are appropriate. These descriptions should be very explicit so someone could read your page and properly reproduce your results.</em></p>

			<p>Our data was collected during a parking survey conducted in Chester Square from 6 a.m. to 8 p.m. on Oct. 29, 2019.</P>
			<p>Filled spots, empty spots, and blocked spots were recorded by hand on the hour.
				We filled this data into a Google Sheet by hand and exported it as a csv file.
				We created both a horizontal bar chart and a map of Chester Square. We cleaned and processed the data with Python.
				For the bar chart data, we iterated through the data and aggregated the number of occupied and empty spots for
				each street for each hour, exporting the result as a csv. For our bar chart,
				our data includes street name as a string, empty spots as an integer, and occupied spots as an integer.
				It also includes the time of day as data type of time.
				In order to preprocess the data for the map, we cleaned, aggregated, and reformatted the data using Python
				with the NumPy and Pandas libraries. The output was a csv file with
			polygon coordinates (floats), occupancy counts (integers), occupancy rates (floats), and percentages (floats).</p>

      <h1>Task Analysis</h1>

	  <table style="border: 1px solid black">
	  <tr id="header">
		<td> Index </td>
		<td> Domain Task </td>
		<td> Analytic Task </td>
		<td> Search Task </td>
		<td> Analyze Task </td>
	  </tr>
	  <tr>
	    <td> 1 </td>
		<td> What are the occupancy rates at different times of the day? </td>
		<td> Identify </td>
		<td> Browse </td>
		<td> Discover </td>
	  </tr><tr>
	    <td> 2 </td>
		<td> What is the average duration a single vehicle is parked? </td>
		<td> Identify </td>
		<td> Lookup </td>
		<td> Present </td>
	  </tr>
	  <tr>
	    <td> 3 </td>
		<td> Where are the problem areas for after-work parking? </td>
		<td> Identify </td>
		<td> Browse </td>
		<td> Present </td>
	  </tr>
	  <tr>
	    <td> 4 </td>
		<td> Who are the owners of vehicles parked in the SA? </td>
		<td> Identify </td>
		<td> Browse </td>
		<td> Discover </td>
	  </tr>
		<td>5 </td>
		<td> How do the various parking regulations affect occupancy and turnover rates? </td>
		<td> Summarize </td>
		<td> Explore </td>
		<td> Present </td>
	  </tr>
	  <tr>
	    <td> 6 </td>
		<td> What are the turnover rates for different times of day? </td>
		<td> Compare </td>
		<td> Browse </td>
		<td> Present </td>
	  </tr>

	  </table>

      <p>This task table shows that our main goal is to understand how the occupancy
			rates fluctuate throughout the day. It is also to understand problem areas for parking.
			What are the areas that most frequently have no available spaces? By understanding
			where the problem areas are and what time of the day issues arise, we can help the Neighborhood
			Association prioritize certain areas for improvement.</p>

      <p><em>Expectation: Clearly describes domain tasks, processes, goals and abstract tasks for domain problems.</em></p>

      <h1>Design Process</h1>
			<p>Below, you can see our initial visualization draft. Originally, we had imagined
			the color scale as red, yellow, and green, but changed it to red, white, and green
			in later iterations.
			because that is more intuitive. We looked at this vis sketch and decided to
			alter the supplementary bar chart to instead focus on street,
			rather than time of day. We wanted both visualizations to represent the same time of day,
			so that the user could look at a single moment in time from two perspectives. </p>
			<img src="Brian_Viz1.jpeg" alt="First visualization sketch" style="width:700px;height:600px;">
			<p>Our next visualization sketch, shown below, was done digitally using Tableau and
				Adobe Illustrator. We changed the color scale to be more intuitive,
				as well as altered the meaning of the bar chart to encompass number of empty/occupied spots, for reasons
				discussed above.
				We also added a filter option for users to filter by regulation in this iteration. We did this
				because we wanted users to have the option to make the vis more granular. We kept the
				slider feature to change the time of day. </p>
			<img src="digitalvissketch.png" alt="Second visualization sketch" style="width:700px;height:600px;">

			<p>INSERT WHAT FINAL DESIGN DECISIONS WERE MADE</p>

      <p><em>Sketches and design choices to justify final visualization.</em></p>

      <p><em>Expectation: Evidence of iterative improvement.
      Logical discussion of design choices grounded in theory from course.
      Discusses feedback from usability testing.</em></p>


      <h1>Conclusion</h1>
	  <p>Parking is an extraordinarily important part of urban life. It allows people
			to own cars and have greater freedom of transportation. But, especially in a
			city like Boston, real estate is incredibly valuable and, well, cars take up
			a lot of space. </p>
		<p> <br>This parking survey was designed to analyze how well parking is being
			used in the Chester Square area in an effort to propose solutions that will
			 better serve the residents. We believe a major and simple solution would be
			 to add lines for parking spots. Parking was almost never used efficiently in
			 Chester Square, as people would park too far apart from each other and there
			 was no consistency with car placement. </p>
		<p><br>For further analysis, we would also recommend a follow-up parking survey
			be performed on a day with more ideal conditions. We were forced to work on a
			 rainy day when there was construction, which skewed our results. </p>


      <h1>Acknowledgements</h1>

      <p><em>List here where any code, packages/libraries, text, images, designs, etc. that you leverage come from.</em></p>

      <ul>
        <li><a href="https://d3js.org/">D3: Data-Driven Documents</a> by Mike Bostock.</li>
        <li><a href="https://codepo8.github.io/css-fork-on-github-ribbon/#">Pure CSS responsive "Fork me on GitHub" ribbon</a> by Chris Heilmann</li>
      </ul>

    </div>

    <!-- Scripts at the end avoid need for dealing with async, defer, or onload event handlers -->
    <script src="lib/d3.v5.12.0/d3.min.js"></script>
    <script src="visualization.js"></script>
	</body>
</html>
